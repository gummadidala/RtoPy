2025-07-31 23:29:54,641 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-07-31 23:29:54.641248
2025-07-31 23:29:54,651 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-07-31 23:29:54,656 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-29 to 2025-07-30
2025-07-31 23:29:54,659 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-07-31 23:29:54,661 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-07-31 23:30:03,367 - configs - INFO - Loaded 5029 corridor records
2025-07-31 23:30:11,336 - configs - INFO - Loaded 5329 corridor records
2025-07-31 23:30:11,414 - botocore.credentials - INFO - Found credentials in environment variables.
2025-07-31 23:30:26,744 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-07-31 23:30:26,748 - monthly_report_calcs_init - INFO - Getting signals list...
2025-07-31 23:30:34,352 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-07-31 23:30:34,354 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-07-31 23:30:35,772 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-07-31 23:30:35,778 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-07-31 23:30:35,781 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-07-31 23:30:36,000 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-07-31 23:30:36,001 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-07-31 23:30:38,619 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-07-31 23:30:38,629 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-07-31 23:30:38,630 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-07-31 23:30:38,632 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-07-31 23:30:38,633 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-07-31 23:30:38,695 - __main__ - INFO - Started: python parse_cctvlog.py
2025-07-31 23:30:38,763 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-07-31 23:30:38,826 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-07-31 23:30:38,889 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-07-31 23:30:38,955 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-07-31 23:30:38,956 - __main__ - INFO - Starting counts processing [4 of 11]
2025-07-31 23:31:27,804 - __main__ - WARNING - Failed counts processing for 2025-07-29
2025-07-31 23:31:27,816 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-07-31 23:31:28,167 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-07-31 23:31:28,167 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-07-31 23:31:28,168 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-07-31 23:31:28,169 - __main__ - INFO - Processing month: 2025-07
2025-07-31 23:31:28,174 - __main__ - INFO - Processing 1-hour adjusted counts
2025-07-31 23:31:28,176 - __main__ - ERROR - Error processing hourly counts: 'str' object has no attribute 'strftime'
2025-07-31 23:31:28,178 - __main__ - ERROR - Error processing month 2025-07: 'str' object has no attribute 'strftime'
2025-07-31 23:31:28,179 - __main__ - ERROR - Monthly Report Calculations Part 1 failed: 'str' object has no attribute 'strftime'
2025-07-31 23:48:25,309 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-07-31 23:48:25.309368
2025-07-31 23:48:25,319 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-07-31 23:48:25,323 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-29 to 2025-07-30
2025-07-31 23:48:25,326 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-07-31 23:48:25,327 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-07-31 23:48:32,295 - configs - INFO - Loaded 5029 corridor records
2025-07-31 23:48:39,204 - configs - INFO - Loaded 5329 corridor records
2025-07-31 23:48:39,281 - botocore.credentials - INFO - Found credentials in environment variables.
2025-07-31 23:48:48,361 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-07-31 23:48:48,365 - monthly_report_calcs_init - INFO - Getting signals list...
2025-07-31 23:48:55,039 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-07-31 23:48:55,040 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-07-31 23:48:56,581 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-07-31 23:48:56,585 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-07-31 23:48:56,588 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-07-31 23:48:56,754 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-07-31 23:48:56,755 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-07-31 23:48:59,161 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-07-31 23:48:59,173 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-07-31 23:48:59,175 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-07-31 23:48:59,176 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-07-31 23:48:59,177 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-07-31 23:48:59,231 - __main__ - INFO - Started: python parse_cctvlog.py
2025-07-31 23:48:59,297 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-07-31 23:48:59,362 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-07-31 23:48:59,424 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-07-31 23:48:59,487 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-07-31 23:48:59,488 - __main__ - INFO - Starting counts processing [4 of 11]
2025-07-31 23:49:47,131 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-07-31 23:49:47,625 - __main__ - WARNING - Failed counts processing for 2025-07-29
2025-07-31 23:49:47,983 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-07-31 23:49:47,984 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-07-31 23:49:47,985 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-07-31 23:49:47,986 - __main__ - INFO - Processing month: 2025-07
2025-07-31 23:49:47,990 - __main__ - INFO - Processing 1-hour adjusted counts
2025-07-31 23:49:47,991 - __main__ - ERROR - Error processing hourly counts: 'str' object has no attribute 'strftime'
2025-07-31 23:49:47,992 - __main__ - ERROR - Error processing month 2025-07: 'str' object has no attribute 'strftime'
2025-07-31 23:49:47,992 - __main__ - ERROR - Monthly Report Calculations Part 1 failed: 'str' object has no attribute 'strftime'
2025-07-31 23:52:46,179 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-07-31 23:52:46.179052
2025-07-31 23:52:46,186 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-07-31 23:52:46,190 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-29 to 2025-07-30
2025-07-31 23:52:46,193 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-07-31 23:52:46,194 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-07-31 23:52:52,733 - configs - INFO - Loaded 5029 corridor records
2025-07-31 23:52:59,820 - configs - INFO - Loaded 5329 corridor records
2025-07-31 23:52:59,909 - botocore.credentials - INFO - Found credentials in environment variables.
2025-07-31 23:53:12,372 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-07-31 23:53:12,374 - monthly_report_calcs_init - INFO - Getting signals list...
2025-07-31 23:53:18,804 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-07-31 23:53:18,805 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-07-31 23:53:20,148 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-07-31 23:53:20,151 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-07-31 23:53:20,153 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-07-31 23:53:20,315 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-07-31 23:53:20,315 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-07-31 23:53:22,521 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-07-31 23:53:22,532 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-07-31 23:53:22,534 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-07-31 23:53:22,535 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-07-31 23:53:22,536 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-07-31 23:53:22,598 - __main__ - INFO - Started: python parse_cctvlog.py
2025-07-31 23:53:22,667 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-07-31 23:53:22,743 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-07-31 23:53:22,800 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-07-31 23:53:22,866 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-07-31 23:53:22,867 - __main__ - INFO - Starting counts processing [4 of 11]
2025-07-31 23:54:11,188 - __main__ - WARNING - Failed counts processing for 2025-07-29
2025-07-31 23:54:11,226 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-07-31 23:54:11,535 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-07-31 23:54:11,537 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-07-31 23:54:11,539 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-07-31 23:54:11,540 - __main__ - INFO - Processing month: 2025-07
2025-07-31 23:54:11,544 - __main__ - INFO - Processing 1-hour adjusted counts
2025-07-31 23:54:11,546 - __main__ - ERROR - Error processing hourly counts: 'str' object has no attribute 'strftime'
2025-07-31 23:54:11,547 - __main__ - ERROR - Error processing month 2025-07: 'str' object has no attribute 'strftime'
2025-07-31 23:54:11,547 - __main__ - ERROR - Monthly Report Calculations Part 1 failed: 'str' object has no attribute 'strftime'
2025-07-31 23:57:53,610 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-07-31 23:57:53.610893
2025-07-31 23:57:53,620 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-07-31 23:57:53,622 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-29 to 2025-07-30
2025-07-31 23:57:53,625 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-07-31 23:57:53,626 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-07-31 23:58:01,348 - configs - INFO - Loaded 5029 corridor records
2025-07-31 23:58:09,080 - configs - INFO - Loaded 5329 corridor records
2025-07-31 23:58:09,183 - botocore.credentials - INFO - Found credentials in environment variables.
2025-07-31 23:58:17,186 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-07-31 23:58:17,190 - monthly_report_calcs_init - INFO - Getting signals list...
2025-07-31 23:58:24,013 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-07-31 23:58:24,013 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-07-31 23:58:25,465 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-07-31 23:58:25,470 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-07-31 23:58:25,473 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-07-31 23:58:25,652 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-07-31 23:58:25,653 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-07-31 23:58:28,060 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-07-31 23:58:28,067 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-07-31 23:58:28,068 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-07-31 23:58:28,069 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-07-31 23:58:28,070 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-07-31 23:58:28,124 - __main__ - INFO - Started: python parse_cctvlog.py
2025-07-31 23:58:28,192 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-07-31 23:58:28,256 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-07-31 23:58:28,322 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-07-31 23:58:28,392 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-07-31 23:58:28,393 - __main__ - INFO - Starting counts processing [4 of 11]
2025-07-31 23:59:16,002 - __main__ - WARNING - Failed counts processing for 2025-07-29
2025-07-31 23:59:16,648 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-07-31 23:59:16,985 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-07-31 23:59:16,986 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-07-31 23:59:16,986 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-07-31 23:59:16,988 - __main__ - INFO - Processing month: 2025-07
2025-07-31 23:59:16,991 - __main__ - INFO - Processing 1-hour adjusted counts
2025-07-31 23:59:16,993 - __main__ - ERROR - Error processing hourly counts: 'str' object has no attribute 'strftime'
2025-07-31 23:59:16,997 - __main__ - ERROR - Error processing month 2025-07: 'str' object has no attribute 'strftime'
2025-07-31 23:59:16,997 - __main__ - ERROR - Monthly Report Calculations Part 1 failed: 'str' object has no attribute 'strftime'
2025-08-01 00:01:25,150 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-08-01 00:01:25.150233
2025-08-01 00:01:25,158 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-08-01 00:01:25,159 - __main__ - ERROR - Monthly Report Calculations Part 1 failed: name 'month_abbrs' is not defined
2025-08-01 00:01:25,160 - __main__ - ERROR - Unexpected error: cannot access local variable 'conf' where it is not associated with a value
2025-08-01 00:01:47,004 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-08-01 00:01:47.004235
2025-08-01 00:01:47,010 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-08-01 00:01:47,013 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-30 to 2025-07-31
2025-08-01 00:01:47,014 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-08-01 00:01:47,014 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-08-01 00:01:54,312 - configs - INFO - Loaded 5029 corridor records
2025-08-01 00:02:01,800 - configs - INFO - Loaded 5329 corridor records
2025-08-01 00:02:01,883 - botocore.credentials - INFO - Found credentials in environment variables.
2025-08-01 00:02:09,862 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-08-01 00:02:09,865 - monthly_report_calcs_init - INFO - Getting signals list...
2025-08-01 00:02:16,327 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-08-01 00:02:16,328 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-08-01 00:02:17,939 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-08-01 00:02:17,946 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-08-01 00:02:17,949 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-08-01 00:02:18,135 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-08-01 00:02:18,136 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-08-01 00:02:20,651 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-08-01 00:02:20,658 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-08-01 00:02:20,660 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-08-01 00:02:20,661 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-08-01 00:02:20,662 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-08-01 00:02:20,716 - __main__ - INFO - Started: python parse_cctvlog.py
2025-08-01 00:02:20,782 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-08-01 00:02:20,850 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-08-01 00:02:20,922 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-08-01 00:02:20,990 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-08-01 00:02:20,991 - __main__ - INFO - Starting counts processing [4 of 11]
2025-08-01 00:03:10,880 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-08-01 00:03:10,902 - __main__ - WARNING - Failed counts processing for 2025-07-31
2025-08-01 00:03:11,226 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-08-01 00:03:11,227 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-08-01 00:03:11,227 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-08-01 00:03:11,228 - __main__ - INFO - Processing month: 2025-07
2025-08-01 00:03:11,232 - __main__ - INFO - Processing 1-hour adjusted counts
2025-08-01 00:03:11,234 - __main__ - ERROR - Error processing hourly counts: 'str' object has no attribute 'strftime'
2025-08-01 00:03:11,237 - __main__ - ERROR - Error processing month 2025-07: 'str' object has no attribute 'strftime'
2025-08-01 00:03:11,237 - __main__ - ERROR - Monthly Report Calculations Part 1 failed: 'str' object has no attribute 'strftime'
2025-08-01 00:04:04,421 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-08-01 00:04:04.421309
2025-08-01 00:04:04,427 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-08-01 00:04:04,431 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-30 to 2025-07-31
2025-08-01 00:04:04,433 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-08-01 00:04:04,434 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-08-01 00:04:10,827 - configs - INFO - Loaded 5029 corridor records
2025-08-01 00:04:17,834 - configs - INFO - Loaded 5329 corridor records
2025-08-01 00:04:17,912 - botocore.credentials - INFO - Found credentials in environment variables.
2025-08-01 00:04:25,811 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-08-01 00:04:25,814 - monthly_report_calcs_init - INFO - Getting signals list...
2025-08-01 00:04:32,290 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-08-01 00:04:32,290 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-08-01 00:04:33,629 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-08-01 00:04:33,633 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-08-01 00:04:33,636 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-08-01 00:04:33,805 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-08-01 00:04:33,806 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-08-01 00:04:36,131 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-08-01 00:04:36,137 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-08-01 00:04:36,138 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-08-01 00:04:36,140 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-08-01 00:04:36,141 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-08-01 00:04:36,198 - __main__ - INFO - Started: python parse_cctvlog.py
2025-08-01 00:04:36,259 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-08-01 00:04:36,325 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-08-01 00:04:36,391 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-08-01 00:04:36,461 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-08-01 00:04:36,462 - __main__ - INFO - Starting counts processing [4 of 11]
2025-08-01 00:05:24,793 - __main__ - WARNING - Failed counts processing for 2025-07-31
2025-08-01 00:05:25,502 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-08-01 00:05:25,816 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-08-01 00:05:25,817 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-08-01 00:05:25,817 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-08-01 00:05:25,818 - __main__ - INFO - Processing month: 2025-07
2025-08-01 00:05:25,821 - __main__ - INFO - Processing 1-hour adjusted counts
2025-08-01 00:06:42,603 - __main__ - INFO - Process interrupted by user
2025-08-01 00:09:06,195 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-08-01 00:09:06.195200
2025-08-01 00:09:06,202 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-08-01 00:09:06,205 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-30 to 2025-07-31
2025-08-01 00:09:06,206 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-08-01 00:09:06,207 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-08-01 00:09:13,432 - configs - INFO - Loaded 5029 corridor records
2025-08-01 00:09:21,829 - configs - INFO - Loaded 5329 corridor records
2025-08-01 00:09:21,929 - botocore.credentials - INFO - Found credentials in environment variables.
2025-08-01 00:09:36,944 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-08-01 00:09:36,947 - monthly_report_calcs_init - INFO - Getting signals list...
2025-08-01 00:09:44,310 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-08-01 00:09:44,312 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-08-01 00:09:45,705 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-08-01 00:09:45,709 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-08-01 00:09:45,711 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-08-01 00:09:45,879 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-08-01 00:09:45,880 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-08-01 00:09:48,245 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-08-01 00:09:48,252 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-08-01 00:09:48,253 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-08-01 00:09:48,255 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-08-01 00:09:48,256 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-08-01 00:09:48,310 - __main__ - INFO - Started: python parse_cctvlog.py
2025-08-01 00:09:48,370 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-08-01 00:09:48,426 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-08-01 00:09:48,493 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-08-01 00:09:48,556 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-08-01 00:09:48,557 - __main__ - INFO - Starting counts processing [4 of 11]
2025-08-01 00:10:37,120 - __main__ - WARNING - Failed counts processing for 2025-07-31
2025-08-01 00:10:37,431 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-08-01 00:10:37,761 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-08-01 00:10:37,761 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-08-01 00:10:37,762 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-08-01 00:10:37,763 - __main__ - INFO - Processing month: 2025-07
2025-08-01 00:10:37,767 - __main__ - INFO - Processing 1-hour adjusted counts
2025-08-01 00:10:57,063 - __main__ - INFO - Process interrupted by user
2025-08-01 00:13:34,438 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-08-01 00:13:34.438350
2025-08-01 00:13:34,448 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-08-01 00:13:34,453 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-30 to 2025-07-31
2025-08-01 00:13:34,455 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-08-01 00:13:34,455 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-08-01 00:13:40,660 - configs - INFO - Loaded 5029 corridor records
2025-08-01 00:13:47,713 - configs - INFO - Loaded 5329 corridor records
2025-08-01 00:13:47,787 - botocore.credentials - INFO - Found credentials in environment variables.
2025-08-01 00:14:00,013 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-08-01 00:14:00,016 - monthly_report_calcs_init - INFO - Getting signals list...
2025-08-01 00:14:06,500 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-08-01 00:14:06,500 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-08-01 00:14:07,907 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-08-01 00:14:07,912 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-08-01 00:14:07,914 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-08-01 00:14:08,084 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-08-01 00:14:08,086 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-08-01 00:14:10,526 - pyathena.common - ERROR - Failed to execute query.
Traceback (most recent call last):
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\common.py", line 584, in _execute
    query_id = retry_api_call(
               ~~~~~~~~~~~~~~^
        self._connection.client.start_query_execution,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **request,
        ^^^^^^^^^^
    ).get("QueryExecutionId")
    ^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\pyathena\util.py", line 82, in retry_api_call
    return retry(func, *args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 601, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\context.py", line 123, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kgummadidala\Desktop\ai_tools\server-env\Lib\site-packages\botocore\client.py", line 1074, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
2025-08-01 00:14:10,533 - monthly_report_calcs_init - ERROR - Error setting up Athena partitions: (pyathena.error.DatabaseError) An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: The S3 location provided to save your query results is invalid. Please check your S3 location is correct and is in the same region and try again. If you continue to see the issue, contact customer support for further assistance.
[SQL: SHOW PARTITIONS atspm2]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-08-01 00:14:10,535 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-08-01 00:14:10,536 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-08-01 00:14:10,537 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-08-01 00:14:10,590 - __main__ - INFO - Started: python parse_cctvlog.py
2025-08-01 00:14:10,662 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-08-01 00:14:10,728 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-08-01 00:14:10,792 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-08-01 00:14:10,861 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-08-01 00:14:10,863 - __main__ - INFO - Starting counts processing [4 of 11]
2025-08-01 00:14:58,640 - __main__ - WARNING - Failed counts processing for 2025-07-31
2025-08-01 00:14:58,652 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-08-01 00:14:58,996 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-08-01 00:14:58,997 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-08-01 00:14:58,998 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-08-01 00:14:59,000 - __main__ - INFO - Processing month: 2025-07
2025-08-01 00:14:59,003 - __main__ - INFO - Processing 1-hour adjusted counts
2025-08-01 00:24:01,661 - __main__ - INFO - Process interrupted by user
2025-08-01 00:24:11,691 - __main__ - INFO - Starting Monthly Report Calculations Part 1 at 2025-08-01 00:24:11.691423
2025-08-01 00:24:11,700 - monthly_report_calcs_init - INFO - Using 8 cores for parallel processing
2025-08-01 00:24:11,708 - monthly_report_calcs_init - INFO - Processing date range: 2025-07-30 to 2025-07-31
2025-08-01 00:24:11,712 - monthly_report_calcs_init - INFO - Month abbreviations: ['2025-07']
2025-08-01 00:24:11,713 - monthly_report_calcs_init - INFO - Loading corridors configuration...
2025-08-01 00:24:21,229 - configs - INFO - Loaded 5029 corridor records
2025-08-01 00:24:32,042 - configs - INFO - Loaded 5329 corridor records
2025-08-01 00:24:32,132 - botocore.credentials - INFO - Found credentials in environment variables.
2025-08-01 00:24:41,122 - monthly_report_calcs_init - INFO - Successfully updated corridors files
2025-08-01 00:24:41,125 - monthly_report_calcs_init - INFO - Getting signals list...
2025-08-01 00:24:50,810 - monthly_report_calcs_init - INFO - Found 0 unique signals
2025-08-01 00:24:50,811 - monthly_report_calcs_init - INFO - Updating detector configuration...
2025-08-01 00:24:52,477 - rpy2.situation - INFO - cffi mode is CFFI_MODE.ANY
2025-08-01 00:24:52,485 - rpy2.situation - INFO - R home found: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1
2025-08-01 00:24:52,488 - rpy2.situation - INFO - R exec path: C:\Users\kgummadidala\AppData\Local\Programs\R\R-4.5.1\bin\x64\R
2025-08-01 00:24:52,700 - monthly_report_calcs_init - WARNING - No detector configuration found
2025-08-01 00:24:52,702 - monthly_report_calcs_init - INFO - Setting up Athena partitions...
2025-08-01 00:24:59,646 - monthly_report_calcs_init - INFO - Adding 1 missing partitions
2025-08-01 00:25:06,295 - database_functions - INFO - Successfully created partition (date='2025-07-31') for gdot_spm_sbox.atspm2
2025-08-01 00:25:06,297 - monthly_report_calcs_init - INFO - Initialization completed successfully
2025-08-01 00:25:06,298 - __main__ - INFO - Starting CCTV log parsing [1 of 11]
2025-08-01 00:25:06,298 - __main__ - INFO - Starting travel times processing [3 of 11]
2025-08-01 00:25:06,352 - __main__ - INFO - Started: python parse_cctvlog.py
2025-08-01 00:25:06,418 - __main__ - INFO - Started: python parse_cctvlog_encoders.py
2025-08-01 00:25:06,497 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_1hr.yaml
2025-08-01 00:25:06,581 - __main__ - INFO - Started: python get_travel_times_v2.py mark travel_times_15min.yaml
2025-08-01 00:25:06,659 - __main__ - INFO - Started: python get_travel_times_1min_v2.py mark
2025-08-01 00:25:06,661 - __main__ - INFO - Starting counts processing [4 of 11]
2025-08-01 00:25:59,046 - __main__ - WARNING - Failed counts processing for 2025-07-30
2025-08-01 00:25:59,077 - __main__ - WARNING - Failed counts processing for 2025-07-31
2025-08-01 00:25:59,504 - __main__ - INFO - ---------------------- Finished counts ---------------------------
2025-08-01 00:25:59,506 - __main__ - INFO - Starting monthly counts-based measures [5 of 11]
2025-08-01 00:25:59,507 - __main__ - INFO - Starting counts-based measures [6 of 11]
2025-08-01 00:25:59,508 - __main__ - INFO - Processing month: 2025-07
2025-08-01 00:25:59,514 - __main__ - INFO - Processing 1-hour adjusted counts
